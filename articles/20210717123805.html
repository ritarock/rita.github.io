<!DOCTYPE html><html><head><meta name="viewport" content="width=device-width"/><meta charSet="utf-8"/><title>MyDocs</title><meta name="next-head-count" content="3"/><link rel="preload" href="/_next/static/css/dd1d8e71a2aa8e7e10f5.css" as="style"/><link rel="stylesheet" href="/_next/static/css/dd1d8e71a2aa8e7e10f5.css" data-n-g=""/><noscript data-n-css=""></noscript><link rel="preload" href="/_next/static/chunks/webpack-189c53927ffd3caf09c3.js" as="script"/><link rel="preload" href="/_next/static/chunks/framework-2f612445bd50b211f15a.js" as="script"/><link rel="preload" href="/_next/static/chunks/main-c8b51cc0a92c3008cd1b.js" as="script"/><link rel="preload" href="/_next/static/chunks/pages/_app-7163558e7d92093a94d2.js" as="script"/><link rel="preload" href="/_next/static/chunks/996-109927db333074874af4.js" as="script"/><link rel="preload" href="/_next/static/chunks/394-1ac6c205f84cbd1b2925.js" as="script"/><link rel="preload" href="/_next/static/chunks/pages/articles/%5Bid%5D-6ddac1fc6283bcb21133.js" as="script"/></head><body><div id="__next"><div><div><div class="bg-gray-600 h-10 leading-10 text-2xl"><a class="no-underline text-gray-100 mx-2" href="/">MyDocs</a></div></div><div class="mx-7"><h1><b># <!-- -->Golang の ORM 試した</b></h1><p>試したリポジトリはここ。</p>
<p><a href="https://github.com/ritarock/sandbox/tree/master/golang/sample_gorm">https://github.com/ritarock/sandbox/tree/master/golang/sample_gorm</a></p>
<h2>DB に接続</h2>
<p><em><strong>gorm.Open(dialect string, args ...interface{})</strong></em> の第一引数には接続するデータベース、第二引数には接続情報。</p>
<p>今回は Docker で実行したのでコンテナが起動しても mysql は起動していない場合があったので 30 秒待つ処理を入れた。</p>
<pre><div class="text-xs" node="[object Object]" style="display:block;overflow-x:auto;padding:0.5em;background:#272822;color:#ddd"><code class="language-go" style="white-space:pre"><span class="hljs-function" style="color:#f92672;font-weight:bold">func</span><span class="hljs-function"> </span><span class="hljs-function" style="color:#a6e22e;font-weight:bold">gormConnect</span><span class="hljs-function hljs-params">()</span><span class="hljs-function"> *</span><span class="hljs-function" style="color:#a6e22e;font-weight:bold">gorm</span><span class="hljs-function">.</span><span class="hljs-function" style="color:#a6e22e;font-weight:bold">DB</span><span> {
</span><span>	DBMS := </span><span style="color:#a6e22e">&quot;mysql&quot;</span><span>
</span><span>	PROTOCOL := </span><span style="color:#a6e22e">&quot;tcp(db:3306)&quot;</span><span>
</span><span>	USER := </span><span style="color:#a6e22e">&quot;user&quot;</span><span>
</span><span>	PASS := </span><span style="color:#a6e22e">&quot;password&quot;</span><span>
</span><span>	DBNAME := </span><span style="color:#a6e22e">&quot;app&quot;</span><span>
</span><span>	CONNECT := USER + </span><span style="color:#a6e22e">&quot;:&quot;</span><span> + PASS + </span><span style="color:#a6e22e">&quot;@&quot;</span><span> + PROTOCOL + </span><span style="color:#a6e22e">&quot;/&quot;</span><span> + DBNAME + </span><span style="color:#a6e22e">&quot;?parseTime=true&quot;</span><span>
</span>
<span>	</span><span style="color:#f92672;font-weight:bold">var</span><span> err error
</span>	db, err := gorm.Open(DBMS, CONNECT)
<span>	</span><span style="color:#f92672;font-weight:bold">if</span><span> err != </span><span style="color:#f92672;font-weight:bold">nil</span><span> {
</span><span>		fmt.Println(</span><span style="color:#a6e22e">&quot;Not ready&quot;</span><span>)
</span>		time.Sleep(time.Second)
<!-- -->		count++
<span>		</span><span style="color:#f92672;font-weight:bold">if</span><span> count &gt; </span><span class="hljs-number">30</span><span> {
</span><span>			</span><span style="color:#a6e22e">panic</span><span>(err.Error())
</span>		}
<span>		</span><span style="color:#f92672;font-weight:bold">return</span><span> gormConnect()
</span>	}
<span>	fmt.Println(</span><span style="color:#a6e22e">&quot;Success connect&quot;</span><span>)
</span><span>	</span><span style="color:#f92672;font-weight:bold">return</span><span> db
</span>}
</code></div></pre>
<h2>モデル</h2>
<p>構造体を定義する。</p>
<p>フィールドの <em><strong>ID</strong></em> は gorm では主キーとなる。 <em><strong>CreatedAt</strong></em> と <em><strong>UpdatedAt</strong></em> はレコードの作成時と更新時に自動的で設定される。</p>
<pre><div class="text-xs" node="[object Object]" style="display:block;overflow-x:auto;padding:0.5em;background:#272822;color:#ddd"><code class="language-go" style="white-space:pre"><span style="color:#f92672;font-weight:bold">type</span><span> Post </span><span style="color:#f92672;font-weight:bold">struct</span><span> {
</span><span>	ID        </span><span style="color:#f92672;font-weight:bold">int</span><span>
</span><span>	Content   </span><span style="color:#f92672;font-weight:bold">string</span><span>
</span><span>	Author    </span><span style="color:#f92672;font-weight:bold">string</span><span> </span><span style="color:#a6e22e">`sql:&quot;not null&quot;`</span><span>
</span>	Comments  []Comment
<!-- -->	CreatedAt time.Time
<!-- -->}
<!-- -->
<span></span><span style="color:#f92672;font-weight:bold">type</span><span> Comment </span><span style="color:#f92672;font-weight:bold">struct</span><span> {
</span><span>	ID        </span><span style="color:#f92672;font-weight:bold">int</span><span>
</span><span>	Content   </span><span style="color:#f92672;font-weight:bold">string</span><span>
</span><span>	Author    </span><span style="color:#f92672;font-weight:bold">string</span><span> </span><span style="color:#a6e22e">`sql:&quot;not null&quot;`</span><span>
</span><span>	PostId    </span><span style="color:#f92672;font-weight:bold">int</span><span>
</span>	CreatedAt time.Time
<!-- -->}
</code></div></pre>
<p>gorm ではフィールドタグ　<em><strong><code node="[object Object]"></code></strong></em> を設定すること制約などの設定を行える。</p>
<p>設定できるものは <a href="https://gorm.io/ja_JP/docs/models.html#Fields-Tags">ここ</a> を参照。</p>
<h2>belongs to</h2>
<p>User は Company に所属している。</p>
<pre><div class="text-xs" node="[object Object]" style="display:block;overflow-x:auto;padding:0.5em;background:#272822;color:#ddd"><code class="language-go" style="white-space:pre"><span style="color:#f92672;font-weight:bold">type</span><span> User </span><span style="color:#f92672;font-weight:bold">struct</span><span> {
</span>  gorm.Model
<span>  Name      </span><span style="color:#f92672;font-weight:bold">string</span><span>
</span><span>  CompanyID </span><span style="color:#f92672;font-weight:bold">int</span><span>
</span>  Company   Company
<!-- -->}
<!-- -->
<span></span><span style="color:#f92672;font-weight:bold">type</span><span> Company </span><span style="color:#f92672;font-weight:bold">struct</span><span> {
</span><span>  ID   </span><span style="color:#f92672;font-weight:bold">int</span><span>
</span><span>  Name </span><span style="color:#f92672;font-weight:bold">string</span><span>
</span>}
</code></div></pre>
<h2>has one</h2>
<p>別のモデルと 1 対 1 の関係。</p>
<pre><div class="text-xs" node="[object Object]" style="display:block;overflow-x:auto;padding:0.5em;background:#272822;color:#ddd"><code class="language-go" style="white-space:pre"><span style="color:#f92672;font-weight:bold">type</span><span> User </span><span style="color:#f92672;font-weight:bold">struct</span><span> {
</span>  gorm.Model
<!-- -->  CreditCard CreditCard
<!-- -->}
<!-- -->
<span></span><span style="color:#f92672;font-weight:bold">type</span><span> CreditCard </span><span style="color:#f92672;font-weight:bold">struct</span><span> {
</span>  gorm.Model
<span>  Number </span><span style="color:#f92672;font-weight:bold">string</span><span>
</span><span>  UserID </span><span style="color:#f92672;font-weight:bold">uint</span><span>
</span>}
</code></div></pre>
<h2>has many</h2>
<p>User は CreditCard を複数持っている。</p>
<pre><div class="text-xs" node="[object Object]" style="display:block;overflow-x:auto;padding:0.5em;background:#272822;color:#ddd"><code class="language-go" style="white-space:pre"><span style="color:#f92672;font-weight:bold">type</span><span> User </span><span style="color:#f92672;font-weight:bold">struct</span><span> {
</span>  gorm.Model
<!-- -->  CreditCards []CreditCard
<!-- -->}
<!-- -->
<span></span><span style="color:#f92672;font-weight:bold">type</span><span> CreditCard </span><span style="color:#f92672;font-weight:bold">struct</span><span> {
</span>  gorm.Model
<span>  Number </span><span style="color:#f92672;font-weight:bold">string</span><span>
</span><span>  UserID </span><span style="color:#f92672;font-weight:bold">uint</span><span>
</span>}
</code></div></pre>
<h2>many to many</h2>
<p>Book は複数の Author を持ち、 Author は複数の本を持っている。</p>
<pre><div class="text-xs" node="[object Object]" style="display:block;overflow-x:auto;padding:0.5em;background:#272822;color:#ddd"><code class="language-go" style="white-space:pre"><span style="color:#f92672;font-weight:bold">type</span><span> Book </span><span style="color:#f92672;font-weight:bold">struct</span><span> {
</span>  gorm.Model
<span>  Authors []Author </span><span style="color:#a6e22e">`gorm:&quot;many2many:author_books&quot;`</span><span>
</span>}
<span></span><span style="color:#f92672;font-weight:bold">type</span><span> Author </span><span style="color:#f92672;font-weight:bold">struct</span><span> {
</span>  gorm.Model
<span>  Books []Book </span><span style="color:#a6e22e">`gorm:&quot;many2many:author_books&quot;`</span><span>
</span>}
</code></div></pre>
<h2>マイグレーション</h2>
<p>足りないカラムの追加、変更、インデックスの作成は行うが、不要になったカラムの削除等は行われない。</p>
<pre><div class="text-xs" node="[object Object]" style="display:block;overflow-x:auto;padding:0.5em;background:#272822;color:#ddd"><code class="language-go" style="white-space:pre"><span>db.AutoMigrate(&amp;Post{}, &amp;Comment{})</span></code></div></pre></div><br/></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"data":{"id":"20210717123805","fileContents":"{\n  \"title\": \"Golang の ORM 試した\",\n  \"date\": 20210717123805,\n  \"tags\": [\n    \"golang\"\n  ],\n  \"bodyContent\": \"試したリポジトリはここ。\\n\\nhttps://github.com/ritarock/sandbox/tree/master/golang/sample_gorm\\n\\n\\n## DB に接続\\n***gorm.Open(dialect string, args ...interface{})*** の第一引数には接続するデータベース、第二引数には接続情報。\\n\\n今回は Docker で実行したのでコンテナが起動しても mysql は起動していない場合があったので 30 秒待つ処理を入れた。\\n```go\\nfunc gormConnect() *gorm.DB {\\n\\tDBMS := \\\"mysql\\\"\\n\\tPROTOCOL := \\\"tcp(db:3306)\\\"\\n\\tUSER := \\\"user\\\"\\n\\tPASS := \\\"password\\\"\\n\\tDBNAME := \\\"app\\\"\\n\\tCONNECT := USER + \\\":\\\" + PASS + \\\"@\\\" + PROTOCOL + \\\"/\\\" + DBNAME + \\\"?parseTime=true\\\"\\n\\n\\tvar err error\\n\\tdb, err := gorm.Open(DBMS, CONNECT)\\n\\tif err != nil {\\n\\t\\tfmt.Println(\\\"Not ready\\\")\\n\\t\\ttime.Sleep(time.Second)\\n\\t\\tcount++\\n\\t\\tif count \u003e 30 {\\n\\t\\t\\tpanic(err.Error())\\n\\t\\t}\\n\\t\\treturn gormConnect()\\n\\t}\\n\\tfmt.Println(\\\"Success connect\\\")\\n\\treturn db\\n}\\n```\\n\\n## モデル\\n構造体を定義する。 \\n\\nフィールドの ***ID*** は gorm では主キーとなる。 ***CreatedAt*** と ***UpdatedAt*** はレコードの作成時と更新時に自動的で設定される。\\n```go\\ntype Post struct {\\n\\tID        int\\n\\tContent   string\\n\\tAuthor    string `sql:\\\"not null\\\"`\\n\\tComments  []Comment\\n\\tCreatedAt time.Time\\n}\\n\\ntype Comment struct {\\n\\tID        int\\n\\tContent   string\\n\\tAuthor    string `sql:\\\"not null\\\"`\\n\\tPostId    int\\n\\tCreatedAt time.Time\\n}\\n```\\n\\ngorm ではフィールドタグ　***`gorm:\\\"\\\"`*** を設定すること制約などの設定を行える。\\n\\n設定できるものは [ここ](https://gorm.io/ja_JP/docs/models.html#Fields-Tags) を参照。\\n\\n\\n## belongs to\\nUser は Company に所属している。\\n```go\\ntype User struct {\\n  gorm.Model\\n  Name      string\\n  CompanyID int\\n  Company   Company\\n}\\n\\ntype Company struct {\\n  ID   int\\n  Name string\\n}\\n```\\n\\n## has one\\n別のモデルと 1 対 1 の関係。\\n```go\\ntype User struct {\\n  gorm.Model\\n  CreditCard CreditCard\\n}\\n\\ntype CreditCard struct {\\n  gorm.Model\\n  Number string\\n  UserID uint\\n}\\n```\\n\\n## has many\\nUser は CreditCard を複数持っている。\\n```go\\ntype User struct {\\n  gorm.Model\\n  CreditCards []CreditCard\\n}\\n\\ntype CreditCard struct {\\n  gorm.Model\\n  Number string\\n  UserID uint\\n}\\n```\\n\\n## many to many\\nBook は複数の Author を持ち、 Author は複数の本を持っている。\\n```go\\ntype Book struct {\\n  gorm.Model\\n  Authors []Author `gorm:\\\"many2many:author_books\\\"`\\n}\\ntype Author struct {\\n  gorm.Model\\n  Books []Book `gorm:\\\"many2many:author_books\\\"`\\n}\\n```\\n\\n## マイグレーション\\n足りないカラムの追加、変更、インデックスの作成は行うが、不要になったカラムの削除等は行われない。\\n```go\\ndb.AutoMigrate(\u0026Post{}, \u0026Comment{})\\n```\",\n  \"bodyHtml\": \"\u003cp\u003e試したリポジトリはここ。\u003c/p\u003e\\n\u003cp\u003ehttps://github.com/ritarock/sandbox/tree/master/golang/sample_gorm\u003c/p\u003e\\n\u003ch2\u003eDB に接続\u003c/h2\u003e\\n\u003cp\u003e\u003cem\u003e\u003cstrong\u003egorm.Open(dialect string, args ...interface{})\u003c/strong\u003e\u003c/em\u003e の第一引数には接続するデータベース、第二引数には接続情報。\u003c/p\u003e\\n\u003cp\u003e今回は Docker で実行したのでコンテナが起動しても mysql は起動していない場合があったので 30 秒待つ処理を入れた。\u003c/p\u003e\\n\u003cpre\u003e\u003ccode class=\\\"hljs\\\"\u003e\u003cspan class=\\\"hljs-function\\\"\u003e\u003cspan class=\\\"hljs-keyword\\\"\u003efunc\u003c/span\u003e \u003cspan class=\\\"hljs-title\\\"\u003egormConnect\u003c/span\u003e\u003cspan class=\\\"hljs-params\\\"\u003e()\u003c/span\u003e *\u003cspan class=\\\"hljs-title\\\"\u003egorm\u003c/span\u003e.\u003cspan class=\\\"hljs-title\\\"\u003eDB\u003c/span\u003e\u003c/span\u003e {\\n\\tDBMS := \u003cspan class=\\\"hljs-string\\\"\u003e\u0026quot;mysql\u0026quot;\u003c/span\u003e\\n\\tPROTOCOL := \u003cspan class=\\\"hljs-string\\\"\u003e\u0026quot;tcp(db:3306)\u0026quot;\u003c/span\u003e\\n\\tUSER := \u003cspan class=\\\"hljs-string\\\"\u003e\u0026quot;user\u0026quot;\u003c/span\u003e\\n\\tPASS := \u003cspan class=\\\"hljs-string\\\"\u003e\u0026quot;password\u0026quot;\u003c/span\u003e\\n\\tDBNAME := \u003cspan class=\\\"hljs-string\\\"\u003e\u0026quot;app\u0026quot;\u003c/span\u003e\\n\\tCONNECT := USER + \u003cspan class=\\\"hljs-string\\\"\u003e\u0026quot;:\u0026quot;\u003c/span\u003e + PASS + \u003cspan class=\\\"hljs-string\\\"\u003e\u0026quot;@\u0026quot;\u003c/span\u003e + PROTOCOL + \u003cspan class=\\\"hljs-string\\\"\u003e\u0026quot;/\u0026quot;\u003c/span\u003e + DBNAME + \u003cspan class=\\\"hljs-string\\\"\u003e\u0026quot;?parseTime=true\u0026quot;\u003c/span\u003e\\n\\n\\t\u003cspan class=\\\"hljs-keyword\\\"\u003evar\u003c/span\u003e err error\\n\\tdb, err := gorm.Open(DBMS, CONNECT)\\n\\t\u003cspan class=\\\"hljs-keyword\\\"\u003eif\u003c/span\u003e err != \u003cspan class=\\\"hljs-literal\\\"\u003enil\u003c/span\u003e {\\n\\t\\tfmt.Println(\u003cspan class=\\\"hljs-string\\\"\u003e\u0026quot;Not ready\u0026quot;\u003c/span\u003e)\\n\\t\\ttime.Sleep(time.Second)\\n\\t\\tcount++\\n\\t\\t\u003cspan class=\\\"hljs-keyword\\\"\u003eif\u003c/span\u003e count \u0026gt; \u003cspan class=\\\"hljs-number\\\"\u003e30\u003c/span\u003e {\\n\\t\\t\\t\u003cspan class=\\\"hljs-built_in\\\"\u003epanic\u003c/span\u003e(err.Error())\\n\\t\\t}\\n\\t\\t\u003cspan class=\\\"hljs-keyword\\\"\u003ereturn\u003c/span\u003e gormConnect()\\n\\t}\\n\\tfmt.Println(\u003cspan class=\\\"hljs-string\\\"\u003e\u0026quot;Success connect\u0026quot;\u003c/span\u003e)\\n\\t\u003cspan class=\\\"hljs-keyword\\\"\u003ereturn\u003c/span\u003e db\\n}\u003c/code\u003e\u003c/pre\u003e\u003ch2\u003eモデル\u003c/h2\u003e\\n\u003cp\u003e構造体を定義する。\u003c/p\u003e\\n\u003cp\u003eフィールドの \u003cem\u003e\u003cstrong\u003eID\u003c/strong\u003e\u003c/em\u003e は gorm では主キーとなる。 \u003cem\u003e\u003cstrong\u003eCreatedAt\u003c/strong\u003e\u003c/em\u003e と \u003cem\u003e\u003cstrong\u003eUpdatedAt\u003c/strong\u003e\u003c/em\u003e はレコードの作成時と更新時に自動的で設定される。\u003c/p\u003e\\n\u003cpre\u003e\u003ccode class=\\\"hljs\\\"\u003e\u003cspan class=\\\"hljs-keyword\\\"\u003etype\u003c/span\u003e Post \u003cspan class=\\\"hljs-keyword\\\"\u003estruct\u003c/span\u003e {\\n\\tID        \u003cspan class=\\\"hljs-keyword\\\"\u003eint\u003c/span\u003e\\n\\tContent   \u003cspan class=\\\"hljs-keyword\\\"\u003estring\u003c/span\u003e\\n\\tAuthor    \u003cspan class=\\\"hljs-keyword\\\"\u003estring\u003c/span\u003e \u003cspan class=\\\"hljs-string\\\"\u003e`sql:\u0026quot;not null\u0026quot;`\u003c/span\u003e\\n\\tComments  []Comment\\n\\tCreatedAt time.Time\\n}\\n\\n\u003cspan class=\\\"hljs-keyword\\\"\u003etype\u003c/span\u003e Comment \u003cspan class=\\\"hljs-keyword\\\"\u003estruct\u003c/span\u003e {\\n\\tID        \u003cspan class=\\\"hljs-keyword\\\"\u003eint\u003c/span\u003e\\n\\tContent   \u003cspan class=\\\"hljs-keyword\\\"\u003estring\u003c/span\u003e\\n\\tAuthor    \u003cspan class=\\\"hljs-keyword\\\"\u003estring\u003c/span\u003e \u003cspan class=\\\"hljs-string\\\"\u003e`sql:\u0026quot;not null\u0026quot;`\u003c/span\u003e\\n\\tPostId    \u003cspan class=\\\"hljs-keyword\\\"\u003eint\u003c/span\u003e\\n\\tCreatedAt time.Time\\n}\u003c/code\u003e\u003c/pre\u003e\u003cp\u003egorm ではフィールドタグ　\u003cem\u003e\u003cstrong\u003e\u003ccode\u003egorm:\u0026quot;\u0026quot;\u003c/code\u003e\u003c/strong\u003e\u003c/em\u003e を設定すること制約などの設定を行える。\u003c/p\u003e\\n\u003cp\u003e設定できるものは \u003ca href=\\\"https://gorm.io/ja_JP/docs/models.html#Fields-Tags\\\"\u003eここ\u003c/a\u003e を参照。\u003c/p\u003e\\n\u003ch2\u003ebelongs to\u003c/h2\u003e\\n\u003cp\u003eUser は Company に所属している。\u003c/p\u003e\\n\u003cpre\u003e\u003ccode class=\\\"hljs\\\"\u003e\u003cspan class=\\\"hljs-keyword\\\"\u003etype\u003c/span\u003e User \u003cspan class=\\\"hljs-keyword\\\"\u003estruct\u003c/span\u003e {\\n  gorm.Model\\n  Name      \u003cspan class=\\\"hljs-keyword\\\"\u003estring\u003c/span\u003e\\n  CompanyID \u003cspan class=\\\"hljs-keyword\\\"\u003eint\u003c/span\u003e\\n  Company   Company\\n}\\n\\n\u003cspan class=\\\"hljs-keyword\\\"\u003etype\u003c/span\u003e Company \u003cspan class=\\\"hljs-keyword\\\"\u003estruct\u003c/span\u003e {\\n  ID   \u003cspan class=\\\"hljs-keyword\\\"\u003eint\u003c/span\u003e\\n  Name \u003cspan class=\\\"hljs-keyword\\\"\u003estring\u003c/span\u003e\\n}\u003c/code\u003e\u003c/pre\u003e\u003ch2\u003ehas one\u003c/h2\u003e\\n\u003cp\u003e別のモデルと 1 対 1 の関係。\u003c/p\u003e\\n\u003cpre\u003e\u003ccode class=\\\"hljs\\\"\u003e\u003cspan class=\\\"hljs-keyword\\\"\u003etype\u003c/span\u003e User \u003cspan class=\\\"hljs-keyword\\\"\u003estruct\u003c/span\u003e {\\n  gorm.Model\\n  CreditCard CreditCard\\n}\\n\\n\u003cspan class=\\\"hljs-keyword\\\"\u003etype\u003c/span\u003e CreditCard \u003cspan class=\\\"hljs-keyword\\\"\u003estruct\u003c/span\u003e {\\n  gorm.Model\\n  Number \u003cspan class=\\\"hljs-keyword\\\"\u003estring\u003c/span\u003e\\n  UserID \u003cspan class=\\\"hljs-keyword\\\"\u003euint\u003c/span\u003e\\n}\u003c/code\u003e\u003c/pre\u003e\u003ch2\u003ehas many\u003c/h2\u003e\\n\u003cp\u003eUser は CreditCard を複数持っている。\u003c/p\u003e\\n\u003cpre\u003e\u003ccode class=\\\"hljs\\\"\u003e\u003cspan class=\\\"hljs-keyword\\\"\u003etype\u003c/span\u003e User \u003cspan class=\\\"hljs-keyword\\\"\u003estruct\u003c/span\u003e {\\n  gorm.Model\\n  CreditCards []CreditCard\\n}\\n\\n\u003cspan class=\\\"hljs-keyword\\\"\u003etype\u003c/span\u003e CreditCard \u003cspan class=\\\"hljs-keyword\\\"\u003estruct\u003c/span\u003e {\\n  gorm.Model\\n  Number \u003cspan class=\\\"hljs-keyword\\\"\u003estring\u003c/span\u003e\\n  UserID \u003cspan class=\\\"hljs-keyword\\\"\u003euint\u003c/span\u003e\\n}\u003c/code\u003e\u003c/pre\u003e\u003ch2\u003emany to many\u003c/h2\u003e\\n\u003cp\u003eBook は複数の Author を持ち、 Author は複数の本を持っている。\u003c/p\u003e\\n\u003cpre\u003e\u003ccode class=\\\"hljs\\\"\u003e\u003cspan class=\\\"hljs-keyword\\\"\u003etype\u003c/span\u003e Book \u003cspan class=\\\"hljs-keyword\\\"\u003estruct\u003c/span\u003e {\\n  gorm.Model\\n  Authors []Author \u003cspan class=\\\"hljs-string\\\"\u003e`gorm:\u0026quot;many2many:author_books\u0026quot;`\u003c/span\u003e\\n}\\n\u003cspan class=\\\"hljs-keyword\\\"\u003etype\u003c/span\u003e Author \u003cspan class=\\\"hljs-keyword\\\"\u003estruct\u003c/span\u003e {\\n  gorm.Model\\n  Books []Book \u003cspan class=\\\"hljs-string\\\"\u003e`gorm:\u0026quot;many2many:author_books\u0026quot;`\u003c/span\u003e\\n}\u003c/code\u003e\u003c/pre\u003e\u003ch2\u003eマイグレーション\u003c/h2\u003e\\n\u003cp\u003e足りないカラムの追加、変更、インデックスの作成は行うが、不要になったカラムの削除等は行われない。\u003c/p\u003e\\n\u003cpre\u003e\u003ccode class=\\\"hljs\\\"\u003edb.AutoMigrate(\u0026amp;Post{}, \u0026amp;Comment{})\u003c/code\u003e\u003c/pre\u003e\",\n  \"dir\": \"articles\",\n  \"base\": \"20210717123805.json\",\n  \"ext\": \".json\",\n  \"sourceBase\": \"20210717123805.md\",\n  \"sourceExt\": \".md\"\n}"}},"__N_SSG":true},"page":"/articles/[id]","query":{"id":"20210717123805"},"buildId":"j0qEr6JZ7JnigW5qKQCVL","isFallback":false,"gsp":true}</script><script nomodule="" src="/_next/static/chunks/polyfills-7b08e4c67f4f1b892f4b.js"></script><script src="/_next/static/chunks/webpack-189c53927ffd3caf09c3.js" async=""></script><script src="/_next/static/chunks/framework-2f612445bd50b211f15a.js" async=""></script><script src="/_next/static/chunks/main-c8b51cc0a92c3008cd1b.js" async=""></script><script src="/_next/static/chunks/pages/_app-7163558e7d92093a94d2.js" async=""></script><script src="/_next/static/chunks/996-109927db333074874af4.js" async=""></script><script src="/_next/static/chunks/394-1ac6c205f84cbd1b2925.js" async=""></script><script src="/_next/static/chunks/pages/articles/%5Bid%5D-6ddac1fc6283bcb21133.js" async=""></script><script src="/_next/static/j0qEr6JZ7JnigW5qKQCVL/_buildManifest.js" async=""></script><script src="/_next/static/j0qEr6JZ7JnigW5qKQCVL/_ssgManifest.js" async=""></script></body></html>