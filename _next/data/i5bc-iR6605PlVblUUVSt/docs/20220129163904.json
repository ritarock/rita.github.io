{"pageProps":{"contents":{"id":"20220129163904","title":"echo で middleware を実装する","body":"\n[公式ドキュメント](https://echo.labstack.com/cookbook/middleware/)を参考に今回はアクセスの回数をログに出力する middleware を実装する。\n\nmiddleware は `echo.HandlerFunc` を返す関数を作れば良さそう。\n\n```go\npackage main\n\nimport (\n\t\"fmt\"\n\t\"sync\"\n\n\t\"github.com/labstack/echo/v4\"\n)\n\ntype Counter struct {\n\tmutex sync.Mutex\n\tvalue int\n}\n\nvar counter = new(Counter)\n\nfunc accessCounter(next echo.HandlerFunc) echo.HandlerFunc {\n\treturn func(c echo.Context) error {\n\t\tcounter.mutex.Lock()\n\t\tcounter.value++\n\t\tcounter.mutex.Unlock()\n\t\tfmt.Println(counter.value)\n\t\treturn next(c)\n\t}\n}\n\nfunc main() {\n\te := echo.New()\n\n\te.Use(accessCounter)\n\te.Start(\":8080\")\n}\n\n```\n"}},"__N_SSG":true}