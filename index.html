<!DOCTYPE html>
<html lang="en-us">
<head>
	<meta name="generator" content="Hugo 0.121.1">
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<style type=text/css>body{font-family:monospace;}</style>
	<title>MyDocs</title>
	
	
	<link rel="stylesheet" href="/css/style.css">
	
	<link rel="alternate" type="application/rss+xml" href="/index.xml" title="MyDocs">
</head>
<body>
	<header>
	============<br>
	== <a href="https://example.org/">MyDocs</a> ==<br>
	============
	<div style="float: right;"></div><br>
	<p>
	<nav>
			
			
			<a href="/tags/"><b>Tags</b></a>
			
	</nav>
	</p>
	
</header>

	
	<main>
		
		
			<article>
	<h1><a href="https://example.org/posts/20231216175817/">ブログを next.js 辞めて hugo にした</a></h1>
	<b><time>2023-12-16 17:58:17</time></b>
	
	<a href="/tags/meta">meta</a>
	
	<div>
		理由は、next.js 13 =&gt; 14 のバージョンアップが面倒くさかったから。
また、勉強して気が向いたら next.js に戻すかもしれない。
next.js 時代の最後のコミットだけ残しておこう。
https://github.com/ritarock/my-docs/commit/f063965f79b6f5a5c02f999bfdc078a15e62005a
		
	</div>
</article>

		
			<article>
	<h1><a href="https://example.org/posts/20230322173450/">Slack のスラッシュコマンドを Lambda で受け取る</a></h1>
	<b><time>2023-03-22 17:34:50</time></b>
	
	<a href="/tags/golang">golang</a>
	
	<div>
		構成は、slack =&gt; API Gateway =&gt; Lambda。
event を Decode する必要がある。
func Handler(event events.APIGatewayProxyRequest) (Response, error) { if err := ensureDecode(&amp;event); err != nil { panic(err) } fmt.Println(event.Body) } func ensureDecode(event *events.APIGatewayProxyRequest) error { if event.IsBase64Encoded { body, err := base64.StdEncoding.DecodeString(event.Body) if err != nil { return err } event.Body = string(body) event.IsBase64Encoded = false } return nil } 
		
	</div>
</article>

		
			<article>
	<h1><a href="https://example.org/posts/20230223173604/">gqlgen を触る</a></h1>
	<b><time>2023-02-23 17:36:04</time></b>
	
	<a href="/tags/golang">golang</a>
	
	<a href="/tags/graphql">graphql</a>
	
	<div>
		database の準備 $ go run -mod=mod entgo.io/ent/cmd/ent new Todo schema の設定。
// Fields of the Todo. func (Todo) Fields() []ent.Field { return []ent.Field{ field.String(&#34;title&#34;), field.String(&#34;note&#34;), field.Bool(&#34;completed&#34;).Default(false), field.Time(&#34;created_at&#34;).Default(time.Now()), field.Time(&#34;updated_at&#34;).Default(time.Now()), } } $ go generate ./ent gqlgen $ printf &#39;// +build tools\npackage tools\nimport (_ &#34;github.com/99designs/gqlgen&#34;\n _ &#34;github.com/99designs/gqlgen/graphql/introspection&#34;)&#39; | gofmt &gt; tools.go $ go mod tidy $ go run github.com/99designs/gqlgen init graph/ に生成されたファイル。
tree graph/ graph/ ├── generated.go # 自動生成 ├── model │ └── models_gen.
		
			<a href="https://example.org/posts/20230223173604/">Read more...</a>
		
	</div>
</article>

		
			<article>
	<h1><a href="https://example.org/posts/20230210174709/">aws-sdk-go-v2 で profile を使う</a></h1>
	<b><time>2023-02-10 17:47:09</time></b>
	
	<a href="/tags/golang">golang</a>
	
	<div>
		profile を指定している場合は profile を使うが、指定していない場合は IAM ロールを使う。
func session(ctx context.Context, profile string) (aws.Config, error) { configOptions := []func(*config.LoadOptions) error{ config.WithRegion(&#34;ap-northeast-1&#34;), } if profile != &#34;&#34; { configOptions = append(configOptions, config.WithSharedConfigProfile(aws.ToString(&amp;profile))) } cfg, err := config.LoadDefaultConfig(ctx, configOptions...) if err != nil { return aws.Config{}, err } return cfg, nil } このコード が参考になった。
		
	</div>
</article>

		
			<article>
	<h1><a href="https://example.org/posts/20230204160502/">github action で日付を扱う</a></h1>
	<b><time>2023-02-04 16:05:02</time></b>
	
	<a href="/tags/github-action">github action</a>
	
	<div>
		name: test on: [workflow_dispatch] jobs: echo-date: runs-on: ubuntu-latest steps: - uses: actions/checkout@v3 - name: set date env: &#34;Asia/Tokyo&#34; run: | echo &#34;CURRENT_DATETIME=$(date +&#39;%Y-%m-%d&#39;)&#34; &gt;&gt; $GITHUB_ENV - name: get date run: | echo ${{ env.CURRENT_DATETIME }} run の中で環境変数の CURRENT_DATETIME に設定することで、以降は ${{ env.CURRENT_DATETIME }} で使うことができる。
		
	</div>
</article>

		
			<article>
	<h1><a href="https://example.org/posts/20221211174737/">rds のパラメータグループを for 文でまとめてかく</a></h1>
	<b><time>2022-12-11 17:47:37</time></b>
	
	<a href="/tags/terraform">terraform</a>
	
	<div>
		モジュール側で map の配列を受け取るようにする。
variable &#34;parameters&#34; { type = list(map(string)) } resource &#34;aws_rds_cluster_parameter_group&#34; &#34;template&#34; { family = &#34;aurora-mysql5.7&#34; name = var.name dynamic &#34;parameter&#34; { for_each = var.parameters content { apply_method = parameter.value[&#34;apply_method&#34;] name = parameter.value[&#34;name&#34;] value = parameter.value[&#34;value&#34;] } } } 呼び出し側で parameters の配列に必要なパラメータを map で書いてあげればよい。
module &#34;parameter_group&#34; { source = &#34;../../modules/aws_rds_cluster_parameter_group&#34; name = &#34;sample-parameter-group&#34; parameters = [ { apply_method : &#34;immediate&#34;, name : &#34;character_set_server&#34;, value : &#34;utf8mb4&#34; }, { apply_method : &#34;pending-reboot&#34;, name : &#34;binlog_format&#34;, value : &#34;MIXED&#34; }, ] } plan 結果。
		
			<a href="https://example.org/posts/20221211174737/">Read more...</a>
		
	</div>
</article>

		
			<article>
	<h1><a href="https://example.org/posts/20220522180736/">cobra-cli を使う</a></h1>
	<b><time>2022-05-22 18:07:36</time></b>
	
	<a href="/tags/golang">golang</a>
	
	<div>
		cobra-cli を使う go.mod を作成 $ go mod init sample go: creating new go.mod: module sample project の開始 init コマンドを実行。
$ go run -mod=mod github.com/spf13/cobra-cli@latest init $ tree tree . ├── LICENSE ├── cmd │ └── root.go ├── go.mod ├── go.sum └── main.go main.go は cmd.Execute() を呼び出しているだけ。
/* Copyright © 2022 NAME HERE &lt;EMAIL ADDRESS&gt; */ package main import &#34;sample/cmd&#34; func main() { cmd.Execute() } cmd/root.go を編集。実行したら Hello を出力する。
/* Copyright © 2022 NAME HERE &lt;EMAIL ADDRESS&gt; */ package cmd import ( &#34;fmt&#34; &#34;os&#34; &#34;github.
		
			<a href="https://example.org/posts/20220522180736/">Read more...</a>
		
	</div>
</article>

		
			<article>
	<h1><a href="https://example.org/posts/20220129163904/">echo で middleware を実装する</a></h1>
	<b><time>2022-01-29 16:39:04</time></b>
	
	<a href="/tags/golang">golang</a>
	
	<div>
		公式ドキュメントを参考に今回はアクセスの回数をログに出力する middleware を実装する。
middleware は echo.HandlerFunc を返す関数を作れば良さそう。
package main import ( &#34;fmt&#34; &#34;sync&#34; &#34;github.com/labstack/echo/v4&#34; ) type Counter struct { mutex sync.Mutex value int } var counter = new(Counter) func accessCounter(next echo.HandlerFunc) echo.HandlerFunc { return func(c echo.Context) error { counter.mutex.Lock() counter.value++ counter.mutex.Unlock() fmt.Println(counter.value) return next(c) } } func main() { e := echo.New() e.Use(accessCounter) e.Start(&#34;:8080&#34;) } 
		
	</div>
</article>

		
			<article>
	<h1><a href="https://example.org/posts/20220108155408/">ent と echo で API 作る</a></h1>
	<b><time>2022-01-08 15:54:08</time></b>
	
	<a href="/tags/golang">golang</a>
	
	<div>
		ent インストール ent と DB の client をインストールする。
$ go get -d entgo.io/ent/cmd/ent $ go get github.com/mattn/go-sqlite3 スキーマの作成 $ go run entgo.io/ent/cmd/ent init Todo ent/schema/todo.go を編集する。
// Fields of the Todo. func (Todo) Fields() []ent.Field { return []ent.Field{ field.String(&#34;name&#34;). Default(&#34;&#34;), field.Bool(&#34;status&#34;). Default(false), field.Time(&#34;created_at&#34;). Default(func() time.Time { return time.Now() }), } } コード生成 shema ファイルを元にコードを生成するので編集後は実行する必要がある。
$ go generate ./ent マイグレーション部分を実装 func main() { client, err := ent.Open(&#34;sqlite3&#34;, &#34;file:todo.sqlite?cache=shared&amp;_fk=1&#34;) if err != nil { log.
		
			<a href="https://example.org/posts/20220108155408/">Read more...</a>
		
	</div>
</article>

		
			<article>
	<h1><a href="https://example.org/posts/20220105212211/">TypeScript の Utility Types</a></h1>
	<b><time>2022-01-05 21:22:11</time></b>
	
	<a href="/tags/typescript">typescript</a>
	
	<div>
		Partial Partial&lt;Type&gt; で指定した型に一時的に切り替えることができる。値を返すときはキャストする必要がある。
interface Todo { title: string; desc: string; date: Date; } function createTodo( title: string, desc: string, date: Date, ): Todo { // let todo: Todo = {} // ここでのエラーを防ぐ let todo: Partial&lt;Todo&gt; = {}; todo.title = title; todo.desc = desc; todo.date = date; return todo as Todo; } Required パラメータが欠損したらエラー。
interface Todo { title: string; desc: string; date: Date; } function createTodo( title: string, desc: string, date: Date, ): Todo { const todo: Required&lt;Todo&gt; = { title: title, desc: desc, date: date, }; return todo; } Readonly 初期化したあとにパラメータを変更できないようにする。
		
			<a href="https://example.org/posts/20220105212211/">Read more...</a>
		
	</div>
</article>

		
		<div>

1 of 6

	<a href="/page/2/">Next Page</a>

</div>

	</main>

	<footer>
	<p>&copy; 2023 <a href="https://example.org/"><b>MyDocs</b></a>.
	</p>
</footer>

</body>
</html>
