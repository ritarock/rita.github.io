<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><title>MyDocs</title><meta name="next-head-count" content="3"/><link rel="preload" href="/_next/static/css/a58c9bb1e05a64ba.css" as="style"/><link rel="stylesheet" href="/_next/static/css/a58c9bb1e05a64ba.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-d38be8d96a62f950.js" defer=""></script><script src="/_next/static/chunks/framework-2c79e2a64abdb08b.js" defer=""></script><script src="/_next/static/chunks/main-a0dca5a2ff5035f1.js" defer=""></script><script src="/_next/static/chunks/pages/_app-f35537586aa9f5dd.js" defer=""></script><script src="/_next/static/chunks/996-eeb5175dbd5dba8f.js" defer=""></script><script src="/_next/static/chunks/635-77cab1cb386ca7f8.js" defer=""></script><script src="/_next/static/chunks/pages/docs/%5Bid%5D-f16bc0121a6e0d8a.js" defer=""></script><script src="/_next/static/Pprqt13nm5vtswVY-tT11/_buildManifest.js" defer=""></script><script src="/_next/static/Pprqt13nm5vtswVY-tT11/_ssgManifest.js" defer=""></script></head><body><div id="__next"><div><a style="text-decoration:none" href="/"><div style="color:black;font-size:22px;cursor:pointer">MyDocs</div></a></div><p></p><h1><b># <!-- -->Golang で json を操作する</b></h1><h2>JSON の解析</h2>
<p>今回使う JSON ファイル。</p>
<pre><div class="sc-bcXHqe lmagiH"><div class="sc-gswNZR jJknjO">json</div><pre node="[object Object]" style="display:block;overflow-x:auto;padding:0.5em;background:#272822;color:#ddd"><code class="language-markdown" style="white-space:pre"><span>{
</span>  &quot;id&quot;: 1,
<!-- -->  &quot;content&quot;: &quot;Hello&quot;,
<!-- -->  &quot;author&quot;: {
<span></span><span style="color:#66d9ef">    &quot;id&quot;: 1,
</span><span style="color:#66d9ef">    &quot;name&quot;: &quot;author1&quot;
</span><span style="color:#66d9ef">  },
</span><span style="color:#66d9ef">  &quot;comments&quot;: [
</span><span style="color:#66d9ef">    {
</span><span style="color:#66d9ef">      &quot;id&quot;: 1,
</span><span style="color:#66d9ef">      &quot;content&quot;: &quot;comment1&quot;,
</span><span style="color:#66d9ef">      &quot;author&quot;: &quot;author2&quot;
</span><span style="color:#66d9ef">    },
</span><span style="color:#66d9ef">    {
</span><span style="color:#66d9ef">      &quot;id&quot;: 2,
</span><span style="color:#66d9ef">      &quot;content&quot;: &quot;comment2&quot;,
</span><span style="color:#66d9ef">      &quot;author&quot;: &quot;author3&quot;
</span><span style="color:#66d9ef">    }
</span><span style="color:#66d9ef">  ]
</span><span style="color:#66d9ef">}
</span><span style="color:#66d9ef"></span></code></pre></div></pre>
<h3>Unmarshal を使う</h3>
<p>文字列データの場合は Unmarshal を使う。</p>
<ul>
<li>構造体を定義</li>
<li>JSON を構造体に格納</li>
</ul>
<pre><div class="sc-bcXHqe lmagiH"><div class="sc-gswNZR jJknjO">go</div><pre node="[object Object]" style="display:block;overflow-x:auto;padding:0.5em;background:#272822;color:#ddd"><code class="language-go" style="white-space:pre"><span style="color:#f92672;font-weight:bold">package</span><span> main
</span>
<span></span><span style="color:#f92672;font-weight:bold">import</span><span> (
</span><span>	</span><span style="color:#a6e22e">&quot;encoding/json&quot;</span><span>
</span><span>	</span><span style="color:#a6e22e">&quot;fmt&quot;</span><span>
</span><span>	</span><span style="color:#a6e22e">&quot;io/ioutil&quot;</span><span>
</span><span>	</span><span style="color:#a6e22e">&quot;os&quot;</span><span>
</span>)
<!-- -->
<span></span><span style="color:#f92672;font-weight:bold">type</span><span> Post </span><span style="color:#f92672;font-weight:bold">struct</span><span> {
</span><span>	Id      </span><span style="color:#f92672;font-weight:bold">int</span><span>    </span><span style="color:#a6e22e">`json:&quot;id&quot;`</span><span>
</span><span>	Content </span><span style="color:#f92672;font-weight:bold">string</span><span> </span><span style="color:#a6e22e">`json:&quot;content&quot;`</span><span>
</span><span>	Author  </span><span style="color:#f92672;font-weight:bold">struct</span><span> {
</span><span>		Id   </span><span style="color:#f92672;font-weight:bold">int</span><span>    </span><span style="color:#a6e22e">`json:&quot;id&quot;`</span><span>
</span><span>		Name </span><span style="color:#f92672;font-weight:bold">string</span><span> </span><span style="color:#a6e22e">`json:&quot;name&quot;`</span><span>
</span><span>	} </span><span style="color:#a6e22e">`json:&quot;author&quot;`</span><span>
</span><span>	Comments []</span><span style="color:#f92672;font-weight:bold">struct</span><span> {
</span><span>		Id      </span><span style="color:#f92672;font-weight:bold">int</span><span>    </span><span style="color:#a6e22e">`json:&quot;id&quot;`</span><span>
</span><span>		Content </span><span style="color:#f92672;font-weight:bold">string</span><span> </span><span style="color:#a6e22e">`json:&quot;content&quot;`</span><span>
</span><span>		Author  </span><span style="color:#f92672;font-weight:bold">string</span><span> </span><span style="color:#a6e22e">`json:&quot;author&quot;`</span><span>
</span><span>	} </span><span style="color:#a6e22e">`json:&quot;comments&quot;`</span><span>
</span>}
<!-- -->
<span></span><span class="hljs-function" style="color:#f92672;font-weight:bold">func</span><span class="hljs-function"> </span><span class="hljs-function" style="color:#a6e22e;font-weight:bold">main</span><span class="hljs-function hljs-params">()</span><span> {
</span><span>	jsonFile, err := os.Open(</span><span style="color:#a6e22e">&quot;file.json&quot;</span><span>)
</span><span>	</span><span style="color:#f92672;font-weight:bold">if</span><span> err != </span><span style="color:#f92672;font-weight:bold">nil</span><span> {
</span>		fmt.Println(err)
<span>		</span><span style="color:#f92672;font-weight:bold">return</span><span>
</span>	}
<span>	</span><span style="color:#f92672;font-weight:bold">defer</span><span> jsonFile.Close()
</span>
<!-- -->	jsonData, err := ioutil.ReadAll(jsonFile)
<span>	</span><span style="color:#f92672;font-weight:bold">if</span><span> err != </span><span style="color:#f92672;font-weight:bold">nil</span><span> {
</span>		fmt.Println(err)
<span>		</span><span style="color:#f92672;font-weight:bold">return</span><span>
</span>	}
<!-- -->
<span>	</span><span style="color:#f92672;font-weight:bold">var</span><span> post Post
</span>	json.Unmarshal(jsonData, &amp;post)
<span>	fmt.Println(post) </span><span style="color:#75715e">// {1 Hello {0 author1} [{1 comment1 author2} {2 comment2 author3}]}</span><span>
</span>}</code></pre></div></pre>
<h3>デコーダを使う</h3>
<p>http.Request の Body のように <code>io.Reader</code> のストリームからデータが入ってくる場合に使う。</p>
<ul>
<li>構造体を定義</li>
<li>デコーダを作成する</li>
<li>JSON を順次処理してデコードする</li>
</ul>
<pre><div class="sc-bcXHqe lmagiH"><div class="sc-gswNZR jJknjO">go</div><pre node="[object Object]" style="display:block;overflow-x:auto;padding:0.5em;background:#272822;color:#ddd"><code class="language-go" style="white-space:pre"><span style="color:#f92672;font-weight:bold">package</span><span> main
</span>
<span></span><span style="color:#f92672;font-weight:bold">import</span><span> (
</span><span>	</span><span style="color:#a6e22e">&quot;encoding/json&quot;</span><span>
</span><span>	</span><span style="color:#a6e22e">&quot;fmt&quot;</span><span>
</span><span>	</span><span style="color:#a6e22e">&quot;io&quot;</span><span>
</span><span>	</span><span style="color:#a6e22e">&quot;os&quot;</span><span>
</span>)
<!-- -->
<span></span><span style="color:#f92672;font-weight:bold">type</span><span> Post </span><span style="color:#f92672;font-weight:bold">struct</span><span> {
</span><span>	Id      </span><span style="color:#f92672;font-weight:bold">int</span><span>    </span><span style="color:#a6e22e">`json:&quot;id&quot;`</span><span>
</span><span>	Content </span><span style="color:#f92672;font-weight:bold">string</span><span> </span><span style="color:#a6e22e">`json:&quot;content&quot;`</span><span>
</span><span>	Author  </span><span style="color:#f92672;font-weight:bold">struct</span><span> {
</span><span>		Id   </span><span style="color:#f92672;font-weight:bold">int</span><span>    </span><span style="color:#a6e22e">`json:&quot;id&quot;`</span><span>
</span><span>		Name </span><span style="color:#f92672;font-weight:bold">string</span><span> </span><span style="color:#a6e22e">`json:&quot;name&quot;`</span><span>
</span><span>	} </span><span style="color:#a6e22e">`json:&quot;author&quot;`</span><span>
</span><span>	Comments []</span><span style="color:#f92672;font-weight:bold">struct</span><span> {
</span><span>		Id      </span><span style="color:#f92672;font-weight:bold">int</span><span>    </span><span style="color:#a6e22e">`json:&quot;id&quot;`</span><span>
</span><span>		Content </span><span style="color:#f92672;font-weight:bold">string</span><span> </span><span style="color:#a6e22e">`json:&quot;content&quot;`</span><span>
</span><span>		Author  </span><span style="color:#f92672;font-weight:bold">string</span><span> </span><span style="color:#a6e22e">`json:&quot;author&quot;`</span><span>
</span><span>	} </span><span style="color:#a6e22e">`json:&quot;comments&quot;`</span><span>
</span>}
<!-- -->
<span></span><span class="hljs-function" style="color:#f92672;font-weight:bold">func</span><span class="hljs-function"> </span><span class="hljs-function" style="color:#a6e22e;font-weight:bold">main</span><span class="hljs-function hljs-params">()</span><span> {
</span><span>	jsonFile, err := os.Open(</span><span style="color:#a6e22e">&quot;file.json&quot;</span><span>)
</span><span>	</span><span style="color:#f92672;font-weight:bold">if</span><span> err != </span><span style="color:#f92672;font-weight:bold">nil</span><span> {
</span>		fmt.Println(err)
<span>		</span><span style="color:#f92672;font-weight:bold">return</span><span>
</span>	}
<span>	</span><span style="color:#f92672;font-weight:bold">defer</span><span> jsonFile.Close()
</span>
<!-- -->	decoder := json.NewDecoder(jsonFile)
<span>	</span><span style="color:#f92672;font-weight:bold">for</span><span> {
</span><span>		</span><span style="color:#f92672;font-weight:bold">var</span><span> post Post
</span>		err := decoder.Decode(&amp;post)
<span>		</span><span style="color:#f92672;font-weight:bold">if</span><span> err == io.EOF {
</span><span>			</span><span style="color:#f92672;font-weight:bold">break</span><span>
</span>		}
<span>		</span><span style="color:#f92672;font-weight:bold">if</span><span> err != </span><span style="color:#f92672;font-weight:bold">nil</span><span> {
</span>			fmt.Println(err)
<span>			</span><span style="color:#f92672;font-weight:bold">return</span><span>
</span>		}
<span>		fmt.Println(post) </span><span style="color:#75715e">// {1 Hello {1 author1} [{1 comment1 author2} {2 comment2 author3}]}</span><span>
</span>	}
<!-- -->}</code></pre></div></pre>
<h2>JSON データを作成する</h2>
<ul>
<li>構造体を定義</li>
<li>構造体を JSON データに組み換え</li>
</ul>
<pre><div class="sc-bcXHqe lmagiH"><div class="sc-gswNZR jJknjO">go</div><pre node="[object Object]" style="display:block;overflow-x:auto;padding:0.5em;background:#272822;color:#ddd"><code class="language-go" style="white-space:pre"><span style="color:#f92672;font-weight:bold">package</span><span> main
</span>
<span></span><span style="color:#f92672;font-weight:bold">import</span><span> (
</span><span>	</span><span style="color:#a6e22e">&quot;encoding/json&quot;</span><span>
</span><span>	</span><span style="color:#a6e22e">&quot;fmt&quot;</span><span>
</span><span>	</span><span style="color:#a6e22e">&quot;io/ioutil&quot;</span><span>
</span>)
<!-- -->
<span></span><span style="color:#f92672;font-weight:bold">type</span><span> Post </span><span style="color:#f92672;font-weight:bold">struct</span><span> {
</span><span>	Id       </span><span style="color:#f92672;font-weight:bold">int</span><span>       </span><span style="color:#a6e22e">`json:&quot;id&quot;`</span><span>
</span><span>	Content  </span><span style="color:#f92672;font-weight:bold">string</span><span>    </span><span style="color:#a6e22e">`json:&quot;content&quot;`</span><span>
</span><span>	Author   Author    </span><span style="color:#a6e22e">`json:&quot;author&quot;`</span><span>
</span><span>	Comments []Comment </span><span style="color:#a6e22e">`json:&quot;comments&quot;`</span><span>
</span>}
<span></span><span style="color:#f92672;font-weight:bold">type</span><span> Author </span><span style="color:#f92672;font-weight:bold">struct</span><span> {
</span><span>	Id   </span><span style="color:#f92672;font-weight:bold">int</span><span>    </span><span style="color:#a6e22e">`json:&quot;id&quot;`</span><span>
</span><span>	Name </span><span style="color:#f92672;font-weight:bold">string</span><span> </span><span style="color:#a6e22e">`json:&quot;name&quot;`</span><span>
</span>}
<span></span><span style="color:#f92672;font-weight:bold">type</span><span> Comment </span><span style="color:#f92672;font-weight:bold">struct</span><span> {
</span><span>	Id      </span><span style="color:#f92672;font-weight:bold">int</span><span>    </span><span style="color:#a6e22e">`json:&quot;id&quot;`</span><span>
</span><span>	Content </span><span style="color:#f92672;font-weight:bold">string</span><span> </span><span style="color:#a6e22e">`json:&quot;content&quot;`</span><span>
</span><span>	Author  </span><span style="color:#f92672;font-weight:bold">string</span><span> </span><span style="color:#a6e22e">`json:&quot;author&quot;`</span><span>
</span>}
<!-- -->
<span></span><span class="hljs-function" style="color:#f92672;font-weight:bold">func</span><span class="hljs-function"> </span><span class="hljs-function" style="color:#a6e22e;font-weight:bold">main</span><span class="hljs-function hljs-params">()</span><span> {
</span>	post := Post{
<span>		Id:      </span><span class="hljs-number">1</span><span>,
</span><span>		Content: </span><span style="color:#a6e22e">&quot;Hello&quot;</span><span>,
</span>		Author: Author{
<span>			Id:   </span><span class="hljs-number">1</span><span>,
</span><span>			Name: </span><span style="color:#a6e22e">&quot;author1&quot;</span><span>,
</span>		},
<!-- -->		Comments: []Comment{
<!-- -->			{
<span>				Id:      </span><span class="hljs-number">1</span><span>,
</span><span>				Content: </span><span style="color:#a6e22e">&quot;comment1&quot;</span><span>,
</span><span>				Author:  </span><span style="color:#a6e22e">&quot;author2&quot;</span><span>,
</span>			},
<!-- -->			{
<span>				Id:      </span><span class="hljs-number">2</span><span>,
</span><span>				Content: </span><span style="color:#a6e22e">&quot;comment2&quot;</span><span>,
</span><span>				Author:  </span><span style="color:#a6e22e">&quot;author3&quot;</span><span>,
</span>			},
<!-- -->		},
<!-- -->	}
<span>	output, err := json.MarshalIndent(&amp;post, </span><span style="color:#a6e22e">&quot;&quot;</span><span>, </span><span style="color:#a6e22e">&quot;\t\t&quot;</span><span>)
</span><span>	</span><span style="color:#f92672;font-weight:bold">if</span><span> err != </span><span style="color:#f92672;font-weight:bold">nil</span><span> {
</span>		fmt.Println(err)
<span>		</span><span style="color:#f92672;font-weight:bold">return</span><span>
</span>	}
<span>	err = ioutil.WriteFile(</span><span style="color:#a6e22e">&quot;created.json&quot;</span><span>, output, </span><span class="hljs-number">0644</span><span>)
</span><span>	</span><span style="color:#f92672;font-weight:bold">if</span><span> err != </span><span style="color:#f92672;font-weight:bold">nil</span><span> {
</span>		fmt.Println(err)
<span>		</span><span style="color:#f92672;font-weight:bold">return</span><span>
</span>	}
<!-- -->}</code></pre></div></pre>
<h3>エンコーダを使う</h3>
<ul>
<li>構造体を定義</li>
<li>エンコーダを作成する</li>
<li>エンコーダを使い構造体を JSON ファイルにエンコード</li>
</ul>
<pre><div class="sc-bcXHqe lmagiH"><div class="sc-gswNZR jJknjO">go</div><pre node="[object Object]" style="display:block;overflow-x:auto;padding:0.5em;background:#272822;color:#ddd"><code class="language-go" style="white-space:pre"><span style="color:#f92672;font-weight:bold">package</span><span> main
</span>
<span></span><span style="color:#f92672;font-weight:bold">import</span><span> (
</span><span>	</span><span style="color:#a6e22e">&quot;encoding/json&quot;</span><span>
</span><span>	</span><span style="color:#a6e22e">&quot;fmt&quot;</span><span>
</span><span>	</span><span style="color:#a6e22e">&quot;os&quot;</span><span>
</span>)
<!-- -->
<span></span><span style="color:#f92672;font-weight:bold">type</span><span> Post </span><span style="color:#f92672;font-weight:bold">struct</span><span> {
</span><span>	Id       </span><span style="color:#f92672;font-weight:bold">int</span><span>       </span><span style="color:#a6e22e">`json:&quot;id&quot;`</span><span>
</span><span>	Content  </span><span style="color:#f92672;font-weight:bold">string</span><span>    </span><span style="color:#a6e22e">`json:&quot;content&quot;`</span><span>
</span><span>	Author   Author    </span><span style="color:#a6e22e">`json:&quot;author&quot;`</span><span>
</span><span>	Comments []Comment </span><span style="color:#a6e22e">`json:&quot;comments&quot;`</span><span>
</span>}
<span></span><span style="color:#f92672;font-weight:bold">type</span><span> Author </span><span style="color:#f92672;font-weight:bold">struct</span><span> {
</span><span>	Id   </span><span style="color:#f92672;font-weight:bold">int</span><span>    </span><span style="color:#a6e22e">`json:&quot;id&quot;`</span><span>
</span><span>	Name </span><span style="color:#f92672;font-weight:bold">string</span><span> </span><span style="color:#a6e22e">`json:&quot;name&quot;`</span><span>
</span>}
<span></span><span style="color:#f92672;font-weight:bold">type</span><span> Comment </span><span style="color:#f92672;font-weight:bold">struct</span><span> {
</span><span>	Id      </span><span style="color:#f92672;font-weight:bold">int</span><span>    </span><span style="color:#a6e22e">`json:&quot;id&quot;`</span><span>
</span><span>	Content </span><span style="color:#f92672;font-weight:bold">string</span><span> </span><span style="color:#a6e22e">`json:&quot;content&quot;`</span><span>
</span><span>	Author  </span><span style="color:#f92672;font-weight:bold">string</span><span> </span><span style="color:#a6e22e">`json:&quot;author&quot;`</span><span>
</span>}
<!-- -->
<span></span><span class="hljs-function" style="color:#f92672;font-weight:bold">func</span><span class="hljs-function"> </span><span class="hljs-function" style="color:#a6e22e;font-weight:bold">main</span><span class="hljs-function hljs-params">()</span><span> {
</span>	post := Post{
<span>		Id:      </span><span class="hljs-number">1</span><span>,
</span><span>		Content: </span><span style="color:#a6e22e">&quot;Hello&quot;</span><span>,
</span>		Author: Author{
<span>			Id:   </span><span class="hljs-number">1</span><span>,
</span><span>			Name: </span><span style="color:#a6e22e">&quot;author1&quot;</span><span>,
</span>		},
<!-- -->		Comments: []Comment{
<!-- -->			{
<span>				Id:      </span><span class="hljs-number">1</span><span>,
</span><span>				Content: </span><span style="color:#a6e22e">&quot;comment1&quot;</span><span>,
</span><span>				Author:  </span><span style="color:#a6e22e">&quot;author2&quot;</span><span>,
</span>			},
<!-- -->			{
<span>				Id:      </span><span class="hljs-number">2</span><span>,
</span><span>				Content: </span><span style="color:#a6e22e">&quot;comment2&quot;</span><span>,
</span><span>				Author:  </span><span style="color:#a6e22e">&quot;author3&quot;</span><span>,
</span>			},
<!-- -->		},
<!-- -->	}
<span>	jsonFile, err := os.Create(</span><span style="color:#a6e22e">&quot;created.json&quot;</span><span>)
</span><span>	</span><span style="color:#f92672;font-weight:bold">if</span><span> err != </span><span style="color:#f92672;font-weight:bold">nil</span><span> {
</span>		fmt.Println(err)
<span>		</span><span style="color:#f92672;font-weight:bold">return</span><span>
</span>	}
<!-- -->	encoder := json.NewEncoder(jsonFile)
<!-- -->	err = encoder.Encode(&amp;post)
<span>	</span><span style="color:#f92672;font-weight:bold">if</span><span> err != </span><span style="color:#f92672;font-weight:bold">nil</span><span> {
</span>		fmt.Println(err)
<span>		</span><span style="color:#f92672;font-weight:bold">return</span><span>
</span>	}
<!-- -->}</code></pre></div></pre></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"contents":{"id":"20210718124235","title":"Golang で json を操作する","body":"\n## JSON の解析\n今回使う JSON ファイル。\n```json\n{\n  \"id\": 1,\n  \"content\": \"Hello\",\n  \"author\": {\n    \"id\": 1,\n    \"name\": \"author1\"\n  },\n  \"comments\": [\n    {\n      \"id\": 1,\n      \"content\": \"comment1\",\n      \"author\": \"author2\"\n    },\n    {\n      \"id\": 2,\n      \"content\": \"comment2\",\n      \"author\": \"author3\"\n    }\n  ]\n}\n\n```\n\n### Unmarshal を使う\n文字列データの場合は Unmarshal を使う。\n\n- 構造体を定義\n- JSON を構造体に格納\n\n```go\npackage main\n\nimport (\n\t\"encoding/json\"\n\t\"fmt\"\n\t\"io/ioutil\"\n\t\"os\"\n)\n\ntype Post struct {\n\tId      int    `json:\"id\"`\n\tContent string `json:\"content\"`\n\tAuthor  struct {\n\t\tId   int    `json:\"id\"`\n\t\tName string `json:\"name\"`\n\t} `json:\"author\"`\n\tComments []struct {\n\t\tId      int    `json:\"id\"`\n\t\tContent string `json:\"content\"`\n\t\tAuthor  string `json:\"author\"`\n\t} `json:\"comments\"`\n}\n\nfunc main() {\n\tjsonFile, err := os.Open(\"file.json\")\n\tif err != nil {\n\t\tfmt.Println(err)\n\t\treturn\n\t}\n\tdefer jsonFile.Close()\n\n\tjsonData, err := ioutil.ReadAll(jsonFile)\n\tif err != nil {\n\t\tfmt.Println(err)\n\t\treturn\n\t}\n\n\tvar post Post\n\tjson.Unmarshal(jsonData, \u0026post)\n\tfmt.Println(post) // {1 Hello {0 author1} [{1 comment1 author2} {2 comment2 author3}]}\n}\n```\n\n### デコーダを使う\nhttp.Request の Body のように `io.Reader` のストリームからデータが入ってくる場合に使う。\n\n- 構造体を定義\n- デコーダを作成する\n- JSON を順次処理してデコードする\n\n```go\npackage main\n\nimport (\n\t\"encoding/json\"\n\t\"fmt\"\n\t\"io\"\n\t\"os\"\n)\n\ntype Post struct {\n\tId      int    `json:\"id\"`\n\tContent string `json:\"content\"`\n\tAuthor  struct {\n\t\tId   int    `json:\"id\"`\n\t\tName string `json:\"name\"`\n\t} `json:\"author\"`\n\tComments []struct {\n\t\tId      int    `json:\"id\"`\n\t\tContent string `json:\"content\"`\n\t\tAuthor  string `json:\"author\"`\n\t} `json:\"comments\"`\n}\n\nfunc main() {\n\tjsonFile, err := os.Open(\"file.json\")\n\tif err != nil {\n\t\tfmt.Println(err)\n\t\treturn\n\t}\n\tdefer jsonFile.Close()\n\n\tdecoder := json.NewDecoder(jsonFile)\n\tfor {\n\t\tvar post Post\n\t\terr := decoder.Decode(\u0026post)\n\t\tif err == io.EOF {\n\t\t\tbreak\n\t\t}\n\t\tif err != nil {\n\t\t\tfmt.Println(err)\n\t\t\treturn\n\t\t}\n\t\tfmt.Println(post) // {1 Hello {1 author1} [{1 comment1 author2} {2 comment2 author3}]}\n\t}\n}\n```\n\n## JSON データを作成する\n- 構造体を定義\n- 構造体を JSON データに組み換え\n\n```go\npackage main\n\nimport (\n\t\"encoding/json\"\n\t\"fmt\"\n\t\"io/ioutil\"\n)\n\ntype Post struct {\n\tId       int       `json:\"id\"`\n\tContent  string    `json:\"content\"`\n\tAuthor   Author    `json:\"author\"`\n\tComments []Comment `json:\"comments\"`\n}\ntype Author struct {\n\tId   int    `json:\"id\"`\n\tName string `json:\"name\"`\n}\ntype Comment struct {\n\tId      int    `json:\"id\"`\n\tContent string `json:\"content\"`\n\tAuthor  string `json:\"author\"`\n}\n\nfunc main() {\n\tpost := Post{\n\t\tId:      1,\n\t\tContent: \"Hello\",\n\t\tAuthor: Author{\n\t\t\tId:   1,\n\t\t\tName: \"author1\",\n\t\t},\n\t\tComments: []Comment{\n\t\t\t{\n\t\t\t\tId:      1,\n\t\t\t\tContent: \"comment1\",\n\t\t\t\tAuthor:  \"author2\",\n\t\t\t},\n\t\t\t{\n\t\t\t\tId:      2,\n\t\t\t\tContent: \"comment2\",\n\t\t\t\tAuthor:  \"author3\",\n\t\t\t},\n\t\t},\n\t}\n\toutput, err := json.MarshalIndent(\u0026post, \"\", \"\\t\\t\")\n\tif err != nil {\n\t\tfmt.Println(err)\n\t\treturn\n\t}\n\terr = ioutil.WriteFile(\"created.json\", output, 0644)\n\tif err != nil {\n\t\tfmt.Println(err)\n\t\treturn\n\t}\n}\n```\n\n### エンコーダを使う\n- 構造体を定義\n- エンコーダを作成する\n- エンコーダを使い構造体を JSON ファイルにエンコード\n\n```go\npackage main\n\nimport (\n\t\"encoding/json\"\n\t\"fmt\"\n\t\"os\"\n)\n\ntype Post struct {\n\tId       int       `json:\"id\"`\n\tContent  string    `json:\"content\"`\n\tAuthor   Author    `json:\"author\"`\n\tComments []Comment `json:\"comments\"`\n}\ntype Author struct {\n\tId   int    `json:\"id\"`\n\tName string `json:\"name\"`\n}\ntype Comment struct {\n\tId      int    `json:\"id\"`\n\tContent string `json:\"content\"`\n\tAuthor  string `json:\"author\"`\n}\n\nfunc main() {\n\tpost := Post{\n\t\tId:      1,\n\t\tContent: \"Hello\",\n\t\tAuthor: Author{\n\t\t\tId:   1,\n\t\t\tName: \"author1\",\n\t\t},\n\t\tComments: []Comment{\n\t\t\t{\n\t\t\t\tId:      1,\n\t\t\t\tContent: \"comment1\",\n\t\t\t\tAuthor:  \"author2\",\n\t\t\t},\n\t\t\t{\n\t\t\t\tId:      2,\n\t\t\t\tContent: \"comment2\",\n\t\t\t\tAuthor:  \"author3\",\n\t\t\t},\n\t\t},\n\t}\n\tjsonFile, err := os.Create(\"created.json\")\n\tif err != nil {\n\t\tfmt.Println(err)\n\t\treturn\n\t}\n\tencoder := json.NewEncoder(jsonFile)\n\terr = encoder.Encode(\u0026post)\n\tif err != nil {\n\t\tfmt.Println(err)\n\t\treturn\n\t}\n}\n```\n"}},"__N_SSG":true},"page":"/docs/[id]","query":{"id":"20210718124235"},"buildId":"Pprqt13nm5vtswVY-tT11","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>