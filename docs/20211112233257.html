<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><title>MyDocs</title><meta name="next-head-count" content="3"/><link rel="preload" href="/_next/static/css/a58c9bb1e05a64ba.css" as="style"/><link rel="stylesheet" href="/_next/static/css/a58c9bb1e05a64ba.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-d38be8d96a62f950.js" defer=""></script><script src="/_next/static/chunks/framework-2c79e2a64abdb08b.js" defer=""></script><script src="/_next/static/chunks/main-348c8faa34e64ab3.js" defer=""></script><script src="/_next/static/chunks/pages/_app-aef446c81fd4cad4.js" defer=""></script><script src="/_next/static/chunks/996-d065d3ec5d2a41d4.js" defer=""></script><script src="/_next/static/chunks/635-fe39bb0306c39624.js" defer=""></script><script src="/_next/static/chunks/pages/docs/%5Bid%5D-f16bc0121a6e0d8a.js" defer=""></script><script src="/_next/static/cuAPPPyJ_mfHEpjFF7Jy1/_buildManifest.js" defer=""></script><script src="/_next/static/cuAPPPyJ_mfHEpjFF7Jy1/_ssgManifest.js" defer=""></script></head><body><div id="__next"><div><a style="text-decoration:none" href="/"><div style="color:black;font-size:22px;cursor:pointer">MyDocs</div></a></div><p></p><h1><b># <!-- -->Go のテストを勉強する</b></h1><p>今まで VSCode の <code>Generate Unit Tests For Function</code> で作成してなんとなくで書いてたけどちゃんと勉強した。</p>
<p><a href="https://github.com/andmorefine/learn-go-with-tests">https://github.com/andmorefine/learn-go-with-tests</a> を使って勉強した。日本語訳が微妙だったので英語版がよかった。</p>
<p>以下メモ。</p>
<ul>
<li><code>t.Helper()</code> を使えば失敗した行が関数呼び出し側になる</li>
<li>Benchmark 実行には <code>go test -bench=.</code> を実行する</li>
<li>カバレッジを確認するには <code>go test -cover</code> を実行する</li>
<li>スライスの test は <code>reflect.DeepEqual</code> を使って変数を比較する。 ただ <code>reflect.DeepEqual</code> は型安全ではないので注意</li>
<li>マップは nil に書き込もうとするとランタイムパニックになるので初期化に気をつける<!-- -->
<ul>
<li>NG: <code>var m map[string]string</code></li>
<li>OK: <code>var dictonary = map[string]string{}</code> もしくは <code>var dictonary = make(map[string]string)</code></li>
</ul>
</li>
<li>標準ライブラリに <code>net/http/httptest</code> があってこれで模擬 HTTP サーバを作れる</li>
<li>&#x27;入力 X のとき出力 Y を期待する&#x27; というテストを作るときはテーブルベースのテストを使う</li>
</ul></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"contents":{"id":"20211112233257","title":"Go のテストを勉強する","body":"\n今まで VSCode の `Generate Unit Tests For Function` で作成してなんとなくで書いてたけどちゃんと勉強した。\n\nhttps://github.com/andmorefine/learn-go-with-tests を使って勉強した。日本語訳が微妙だったので英語版がよかった。\n\n以下メモ。\n- `t.Helper()` を使えば失敗した行が関数呼び出し側になる\n- Benchmark 実行には `go test -bench=.` を実行する\n- カバレッジを確認するには `go test -cover` を実行する\n- スライスの test は `reflect.DeepEqual` を使って変数を比較する。 ただ `reflect.DeepEqual` は型安全ではないので注意\n- マップは nil に書き込もうとするとランタイムパニックになるので初期化に気をつける\n  - NG: `var m map[string]string`\n  - OK: `var dictonary = map[string]string{}` もしくは `var dictonary = make(map[string]string)`\n- 標準ライブラリに `net/http/httptest` があってこれで模擬 HTTP サーバを作れる\n- '入力 X のとき出力 Y を期待する' というテストを作るときはテーブルベースのテストを使う\n"}},"__N_SSG":true},"page":"/docs/[id]","query":{"id":"20211112233257"},"buildId":"cuAPPPyJ_mfHEpjFF7Jy1","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>