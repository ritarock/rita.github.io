<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><title>MyDocs</title><meta name="next-head-count" content="3"/><link rel="preload" href="/_next/static/css/a58c9bb1e05a64ba.css" as="style"/><link rel="stylesheet" href="/_next/static/css/a58c9bb1e05a64ba.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-d38be8d96a62f950.js" defer=""></script><script src="/_next/static/chunks/framework-2c79e2a64abdb08b.js" defer=""></script><script src="/_next/static/chunks/main-4c0bfde4693f048b.js" defer=""></script><script src="/_next/static/chunks/pages/_app-2d6bf7b3192a8752.js" defer=""></script><script src="/_next/static/chunks/996-96c017f2628f3a7d.js" defer=""></script><script src="/_next/static/chunks/238-6c9572b4a47f3e2a.js" defer=""></script><script src="/_next/static/chunks/pages/docs/%5Bid%5D-11871a0dd3bce32a.js" defer=""></script><script src="/_next/static/WO88-BZ4H50Eu4wzY2ZqE/_buildManifest.js" defer=""></script><script src="/_next/static/WO88-BZ4H50Eu4wzY2ZqE/_ssgManifest.js" defer=""></script></head><body><div id="__next"><div><a style="text-decoration:none" href="/"><div style="color:black;font-size:22px;cursor:pointer">MyDocs</div></a></div><p></p><h1><b># <!-- -->Slack のスラッシュコマンドを Lambda で受け取る</b></h1><p>構成は、slack =&gt; API Gateway =&gt; Lambda。</p>
<p>event を <code>Decode</code> する必要がある。</p>
<pre><div class="sc-bgqQcB dzTJyN"><div class="sc-gTRrQi bBvEVj">go</div><pre node="[object Object]" style="display:block;overflow-x:auto;padding:0.5em;background:#272822;color:#ddd"><code class="language-go" style="white-space:pre"><span class="hljs-function" style="color:#f92672;font-weight:bold">func</span><span class="hljs-function"> </span><span class="hljs-function" style="color:#a6e22e;font-weight:bold">Handler</span><span class="hljs-function hljs-params">(event events.APIGatewayProxyRequest)</span><span class="hljs-function"> </span><span class="hljs-function hljs-params">(Response, error)</span><span> {
</span><span>	</span><span style="color:#f92672;font-weight:bold">if</span><span> err := ensureDecode(&amp;event); err != </span><span style="color:#f92672;font-weight:bold">nil</span><span> {
</span><span>		</span><span style="color:#a6e22e">panic</span><span>(err)
</span>	}
<!-- -->	fmt.Println(event.Body)
<!-- -->}
<!-- -->
<span></span><span class="hljs-function" style="color:#f92672;font-weight:bold">func</span><span class="hljs-function"> </span><span class="hljs-function" style="color:#a6e22e;font-weight:bold">ensureDecode</span><span class="hljs-function hljs-params">(event *events.APIGatewayProxyRequest)</span><span class="hljs-function"> </span><span class="hljs-function" style="color:#a6e22e;font-weight:bold">error</span><span> {
</span><span>	</span><span style="color:#f92672;font-weight:bold">if</span><span> event.IsBase64Encoded {
</span>		body, err := base64.StdEncoding.DecodeString(event.Body)
<span>		</span><span style="color:#f92672;font-weight:bold">if</span><span> err != </span><span style="color:#f92672;font-weight:bold">nil</span><span> {
</span><span>			</span><span style="color:#f92672;font-weight:bold">return</span><span> err
</span>		}
<span>		event.Body = </span><span style="color:#f92672;font-weight:bold">string</span><span>(body)
</span><span>		event.IsBase64Encoded = </span><span style="color:#f92672;font-weight:bold">false</span><span>
</span>	}
<span>	</span><span style="color:#f92672;font-weight:bold">return</span><span> </span><span style="color:#f92672;font-weight:bold">nil</span><span>
</span>}</code></pre></div></pre></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"contents":{"id":"20230322173450","title":"Slack のスラッシュコマンドを Lambda で受け取る","body":"\n構成は、slack =\u003e API Gateway =\u003e Lambda。\n\nevent を `Decode` する必要がある。\n```go\nfunc Handler(event events.APIGatewayProxyRequest) (Response, error) {\n\tif err := ensureDecode(\u0026event); err != nil {\n\t\tpanic(err)\n\t}\n\tfmt.Println(event.Body)\n}\n\nfunc ensureDecode(event *events.APIGatewayProxyRequest) error {\n\tif event.IsBase64Encoded {\n\t\tbody, err := base64.StdEncoding.DecodeString(event.Body)\n\t\tif err != nil {\n\t\t\treturn err\n\t\t}\n\t\tevent.Body = string(body)\n\t\tevent.IsBase64Encoded = false\n\t}\n\treturn nil\n}\n```\n"}},"__N_SSG":true},"page":"/docs/[id]","query":{"id":"20230322173450"},"buildId":"WO88-BZ4H50Eu4wzY2ZqE","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>